<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<style>
    *{
        box-sizing:border-box;
        margin:0;
        padding:0;
    }
    canvas{
        height:300px;
        width:600px;;
    }
    div{
        height:100px;
        width:100px;
    }


</style>
<body>
<h1></h1>
<div></div>
<canvas id='canvas' height="300" width="600"></canvas>

<script>

    var canvas = document.querySelector('#canvas'),
            context = canvas.getContext('2d');
    var img = document.createElement('img');
    var i = 0;
    var total;
    img.src = '../../demo/img/cat.jpg';
    //img.src='https://www.vv726.top/demo/img/cat.jpg';
    var height;
    var width;
    var radio;
    img.onload = function(e) {
        total = Math.floor(img.height/50);
//        var radio = img.height/img.width;
//        var height = canvas.width*radio;
//        img.width = canvas.width;
//        img.height = height;



//        400 600
//        1000 600
//
//        radio 0.6
//        width 400
//        height 240


        if( img.width > img.height ){
            radio = img.height/img.width;
            width = canvas.width;
            height = canvas.width * radio;
        }else{
            radio = img.width/img.height;
            height = canvas.height;
            width = canvas.width * radio;
        }
        //context.drawImage(img, 0, 0, 1024, 600, 0, 0, 500, 300);

        run();
       // context.drawImage(img,0,0,canvas.width,canvas.height);
        //context.drawImage(img,0,0,img.width,img.height,0,0,canvas.width,canvas.height);
    }
    function run() {
        setTimeout(function() {
            //context.drawImage(img,sx,sy,swidth,sheight,x,y,width,height);
            context.drawImage(img, 0, 0, img.width,50*i , 0, 0, canvas.width, 50*i);
            i++;
            //var data = context.getImageData(0, 450, 1, 1);
            //console.log(data)
            //console.log(i,total)
            if( i < total ) {
                run();
            }
        }, 300)
    }
    canvas.onmousemove = function(e) {
        var offset = canvas.getBoundingClientRect();
        var imageData = context.getImageData(e.clientX - offset.left, e.clientY - offset.top, 1, 1)
        var pixel = imageData.data;
        var pixelColor = 'rgba(' + pixel[0] + ',' + pixel[1] + ',' + pixel[2] + ',' + pixel[3] + ')'
        document.querySelector('h1').innerHTML = pixelColor;
        document.querySelector('div').style.backgroundColor = pixelColor;
    }


</script>
</body>
</html>